process SIPIXELDQM = {

  #=========================================================================================
  # Sources
    # source of simulated hits
    source = PoolSource
    {
      untracked vstring fileNames	    = 
      #{'file:digis.root'}
      {'rfio:/castor/cern.ch/user/c/chiochia/cmssw/Muon_FullValidation_150pre3.root'}
      untracked uint32  debugVebosity = 10
      untracked bool	debugFlag     = true
    }
    untracked PSet maxEvents = {untracked int32 input = 1000}
  # End Sources
  #=========================================================================================

  # MessageLogger service
 	 include "FWCore/MessageLogger/data/MessageLogger.cfi"

  #=========================================================================================
    service = AdaptorConfig {}
  #=========================================================================================
  # Geometry
	# Tracker SimGeometryXML
  	include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"
  	# include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  	# include "Geometry/TrackerRecoData/data/trackerRecoGeometryXML.cfi"
  	# include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"

  	# Tracker Geometry Builder
  	include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  	# Tracker Numbering Builder
  	include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  	# strip parameter estimator service for SiStripRecHitConverter
  	include "RecoLocalTracker/SiStripRecHitConverter/data/StripCPEfromTrackAngle.cfi"
   
   	# magn. field
   	include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # End Geometry
  #=========================================================================================

  # Reco Modules:
    # SiPixel Clusterizer
  #	include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"

    # SiPixelRecHitConverter
   #	include "RecoLocalTracker/SiPixelRecHits/data/SiPixelRecHits.cfi"

    # SiStripClusterizer
  	# include "RecoLocalTracker/SiStripClusterizer/data/SiStripClusterizer_SimData.cfi"
  	# replace SiStripNoiseServiceParameters.UseCalibDataFromDB = false

    # SiStripRecHitConverter
  #	include "RecoLocalTracker/SiStripRecHitConverter/data/SiStripRecHitConverter.cfi"
  	##include "RecoLocalTracker/SiStripRecHitConverter/data/SiStripRecHitMatcher.cfi"
    
    # GlobalMixedSeedGenerator
  #	include "RecoTracker/TkSeedGenerator/data/GlobalMixedSeeds.cff"
  
    # KFTrackCandidateMaker
  #	include "RecoTracker/CkfPattern/data/CkfTrackCandidates.cff"
   
    # CTF analytical track fit
  	# include "RecoTracker/TrackProducer/data/CTFFinalFitAnalytical.cff"
   
    # CTF track fit with material
  #	include "RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cff"

    # MonitorTrackGlobal
  #	include "DQM/TrackerMonitorTrack/data/MonitorTrackGlobal.cfi"
  #	replace MonitorTrackGlobal.TrackProducer = "ctfWithMaterialTracks"

    # validation
  #	include "Validation/RecoTrack/data/SiPixelTrackingRecHitsValid.cfi"

    # print out what data is contained in the event where the module is in the path
  #	module EventContentAnalyzer = EventContentAnalyzer {}
  
  #=========================================================================================
  # SiPixel DQM Modules:
    # SiPixelMonitorRawData
  #  	include "DQM/SiPixelMonitorRawData/data/SiPixelMonitorRawData.cfi"

    # SiPixelMonitorDigi
    	include "DQM/SiPixelMonitorDigi/data/SiPixelMonitorDigi.cfi"

    # SiPixelMonitorCluster
    	include "DQM/SiPixelMonitorCluster/data/SiPixelMonitorCluster.cfi"

    # SiPixelMonitorTrack
  #  	include "DQM/SiPixelMonitorTrack/data/SiPixelMonitorTrackResiduals.cfi"

  ################ The Client (SiPixelEDAClient) ################
   module sipixelEDAClient = SiPixelEDAClient {
     untracked int32  CollationtionFlag = 0
     untracked int32  FileSaveFrequency = 50
     untracked int32  StaticUpdateFrequency = 10
     untracked string OutputFilePath = "."     
   }
  # End Modules Configuration
  #=========================================================================================
  
  # DQM services
  	service = DaqMonitorROOTBackEnd{}
	service = DQMShipMonitoring{ untracked uint32 period = 1000 }

  #=========================================================================================

  # tracer service - very verbose - useful for debugging only
#  service = Tracer { untracked string indention = "$$"}

   service = ModuleWebRegistry { }

   service = LockService { untracked vstring labels = { "source" } }

######################## Scheduling
    sequence RAWmonitor = {
      SiPixelRawDataErrorSource
    }
    sequence DIGImonitor = {
      SiPixelDigiSource
    }
    sequence CLUmonitor = {
      #siPixelClusters,
      SiPixelClusterSource
    }
    sequence TRKlocalreco = {
      siPixelClusters,
      # siStripClusters,
      siPixelRecHits, 
      siStripMatchedRecHits
    } 
    sequence TRKlocalrec = {
      # siStripClusters,
      siPixelRecHits, 
      siStripMatchedRecHits
    } 
    sequence TRKckf = {
      globalMixedSeeds,
      #ckfTrackCandidates,
      #ctfAnalyticalTracks,
      ctfWithMaterialTracks
    }
    sequence TRKmonitor = {
      MonitorTrackGlobal,
      SiPixelMonitorTrackResiduals
    }
  # End Schedule
  #=========================================================================================
  path p = {DIGImonitor,CLUmonitor,sipixelEDAClient}

}
