process SIPIXELDQM = {

  #=========================================================================================
  # Sources
    # source of simulated hits
    source = PoolSource
    {
      untracked vstring fileNames	    = 
      #{'file:digis.root'}
      #{"file:/afs/cern.ch/user/a/andrewdc/public/digis.root"}
      #{'file:/afs/cern.ch/user/m/merkelp/scratch0/PhysicsData_511_digis.root'}
      {'rfio:/castor/cern.ch/user/c/chiochia/cmssw/Muon_FullValidation_150pre3.root'}
      #{'rfio:/castor/cern.ch/user/g/genta/Validation/CMSSW_2_1_X_2008-04-17-0200/Muon_FullValidation.root'}
      #{'rfio:/castor/cern.ch/user/c/chiochia/cmssw/QCD_210_FEVTSIM_2008_04_17.root'}
      #{'rfio:/castor/cern.ch/user/c/chiochia/cmssw/mu_pt10_210_PixelOnly.root'}
      #{'rfio:/castor/cern.ch/cms/store/data/GlobalMar08/A/000/000/000/RAW/0000/045A3B89-9BEF-DC11-AC9E-000423D6CAF2.root'}
      #{'rfio:/castor/cern.ch/cms/store/data/CRUZET2/Cosmics/RAW/v1/000/046/873/04D28BCA-1F39-DD11-A6C1-001617C3B65A.root'}
     untracked uint32  debugVebosity = 1
      untracked bool	debugFlag     = true
    }
    untracked PSet maxEvents = {untracked int32 input = -1}
  # End Sources
  #=========================================================================================

  # MessageLogger service
 	 #include "FWCore/MessageLogger/data/MessageLogger.cfi"
    service = MessageLogger {
        untracked vstring destinations = { "cout" }
        untracked PSet cout = { untracked string threshold = "WARNING" }
        untracked vstring debugModules   = { "siPixelDigis",
                                             "SiPixelRawDataErrorSource",
                                             "SiPixelDigiSource",
                                             "SiPixelClusterSource",
                                             "SiPixelRecHitSource",
                                             "sipixelEDAClient"}
    }


  #=========================================================================================
    service = AdaptorConfig {}
  #=========================================================================================
  # Geometry
	# Tracker SimGeometryXML
  	include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"
  	# Tracker Geometry Builder
  	include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
  	# Tracker Numbering Builder
  	include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
   	# magn. field
   	include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # End Geometry
  
  #=========================================================================================
  # Raw2digi reconstruction:
        include "EventFilter/SiPixelRawToDigi/data/SiPixelRawToDigi.cfi"
        replace siPixelDigis.InputLabel = "source"
        replace siPixelDigis.IncludeErrors = true
	
  # Pixel Clusterizer:
        include "CalibTracker/Configuration/data/Tracker_FakeConditions.cff"
        # Gain Calibration DB ESSource
        # include "CondTools/SiPixel/data/SiPixelGainCalibrationESSource.cfi"
        include "CalibTracker/SiPixelESProducers/data/SiPixelFakeGainESSource.cfi"      
	include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"
	
  # Pixel RecHits:
      #  include "Configuration/StandardSequences/data/Reconstruction.cff"
        #include "Validation/Performance/test/FakeConditions.cff"
      #  include "Configuration/StandardSequences/data/FrontierConditions_GlobalTag.cff" 
      #  replace GlobalTag.globaltag = "IDEAL_V1::All"

  #=========================================================================================
  # SiPixel DQM Modules:
    # SiPixelMonitorRawData
    	include "DQM/SiPixelMonitorRawData/data/SiPixelMonitorRawData.cfi"
        replace SiPixelRawDataErrorSource.saveFile = false
	replace SiPixelRawDataErrorSource.isPIB = false
	replace SiPixelRawDataErrorSource.slowDown = false

    # SiPixelMonitorDigi
    	include "DQM/SiPixelMonitorDigi/data/SiPixelMonitorDigi.cfi"
        replace SiPixelDigiSource.saveFile = false
	replace SiPixelDigiSource.isPIB = false
	replace SiPixelDigiSource.slowDown = false
	replace SiPixelDigiSource.modOn = false
	replace SiPixelDigiSource.ladOn = true
	replace SiPixelDigiSource.layOn = true
	replace SiPixelDigiSource.phiOn = true
	replace SiPixelDigiSource.bladeOn = true	
	replace SiPixelDigiSource.diskOn = true
        replace SiPixelDigiSource.ringOn = true
	
    # SiPixelMonitorCluster
    	include "DQM/SiPixelMonitorCluster/data/SiPixelMonitorCluster.cfi"
        replace SiPixelClusterSource.saveFile = false
	replace SiPixelClusterSource.modOn = false
	replace SiPixelClusterSource.ladOn = true
	replace SiPixelClusterSource.layOn = true
	replace SiPixelClusterSource.phiOn = true
	replace SiPixelClusterSource.bladeOn = true    
	replace SiPixelClusterSource.diskOn = true
        replace SiPixelClusterSource.ringOn = true
	
    # SiPixelMonitorRecHit
	include "DQM/SiPixelMonitorRecHit/data/SiPixelMonitorRecHit.cfi"
	replace SiPixelRecHitSource.saveFile = false   
	replace SiPixelRecHitSource.modOn = false 
	replace SiPixelRecHitSource.ladOn = true       
	replace SiPixelRecHitSource.layOn = true  
	replace SiPixelRecHitSource.phiOn = true  
	replace SiPixelRecHitSource.bladeOn = true  
	replace SiPixelRecHitSource.ringOn = true  
	replace SiPixelRecHitSource.diskOn = true
	  
  ################ The Client (SiPixelEDAClient) ################
   module sipixelEDAClient = SiPixelEDAClient {
     untracked int32  FileSaveFrequency = 50
     untracked int32  StaticUpdateFrequency = 10
   }

  #=========================================================================================
  
  # DQM services
    include "DQMServices/Core/data/DQM.cfg"    
 #   replace DQMStore.referenceFileName = "Reference.root"
    replace DQM.collectorHost = ""
      
    include "DQMServices/Components/data/DQMEnvironment.cfi"
    replace dqmSaver.convention    = "Online"
    replace dqmSaver.producer        = "DQM"
    replace dqmEnv.subSystemFolder   = "Pixel"
    # replace dqmSaver.forceRunNumber  = -1
    replace dqmSaver.saveByLumiSection =  1
    # replace dqmSaver.saveByMinute = -1
    # replace dqmSaver.saveByEvent =  -1
    replace dqmSaver.saveByRun =     1
    replace dqmSaver.saveAtJobEnd = true

    module qTester = QualityTester {
      untracked FileInPath qtList = "DQM/SiPixelMonitorClient/test/sipixel_qualitytest_config.xml"
      untracked bool getQualityTestsFromFile = true
      untracked int32 QualityTestPrescaler = 1
    }

  #=========================================================================================

   service = ModuleWebRegistry { }
   service = LockService { untracked vstring labels = { "source" } }

######################## Scheduling
    sequence Reco = {
      #siPixelDigis,
      siPixelClusters
      #siPixelRecHits
    }
    sequence RAWmonitor = {
      SiPixelRawDataErrorSource
    }
    sequence DIGImonitor = {
      SiPixelDigiSource
    }
    sequence CLUmonitor = {
      SiPixelClusterSource
    }
    sequence HITmonitor = {
      SiPixelRecHitSource
    }
    sequence DQMmodules = {
      qTester,
      dqmEnv,
      dqmSaver
    }
    
  # End Schedule
  #=========================================================================================
  path p = {Reco,DQMmodules,DIGImonitor,CLUmonitor,HITmonitor,sipixelEDAClient}
  #path p = {Reco,DQMmodules,RAWmonitor,DIGImonitor,sipixelEDAClient}

}
